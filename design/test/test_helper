assert_status_equal () {
  expected=$1; actual=$2; lineno=$3

  if [ $actual -eq $expected ]
  then
    printf '.'
  else
    printf 'F'
    echo "$TEST_CASE:$TEST_NAME" 1>&2
    echo "expected exit status $expected but was $actual" 1>&2
    echo "[$0:$lineno]\n" 1>&2
  fi
}

run_tests () {
  test_file=$1
  
  eval "$(
  grep -oE "^ *${NAME:-test_\w+} +\(\)" "$test_file" | 
  tr -d " ()" | 
  sed "s/^\([A-Za-z0-9_]\{1,\}\)/TEST_NAME=\1 \1/"
  )"
}